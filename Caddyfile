{
    admin localhost:2019
    auto_https off 
}

:8000 {
    log {
        output stdout
        format json
    }

    # 1. Django Admin Route (The primary domain)
    @admin_host host admin.nepdora.com
    handle @admin_host {
        reverse_proxy localhost:8001 {
             # CRITICAL: Pass WebSocket headers for Django Channels to work
             header_up Upgrade {header.Upgrade}
             header_up Connection {header.Connection}
             header_up Host {http.request.host} # Pass original host
        }
    }

    # 2. Fallback Route: Catches any unmatched host.
    handle {
        respond "Sales CRM Gateway: Route not found for {host}" 404
    }
}